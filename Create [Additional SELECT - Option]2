 /*11. 학번이 A313047 인 학생이 학교에 나오고 있지 않다. 지도 교수에게 내용을 전달하기
위한 학과 이름, 학생 이름과 지도 교수 이름이 필요하다. 이때 사용한 SQL 문을 작성하시오. 
단, 출력헤더는 ‚학과이름‛, ‚학생이름‛, ‚지도교수이름‛으로 출력되도록 한다.*/

 
SELECT
      A.DEPARTMENT_NAME 학과이름
    , B.STUDENT_NAME 학생이름
    , C.PROFESSOR_NAME  지도교수이름
  FROM TB_DEPARTMENT A   
  JOIN TB_STUDENT B ON (A.DEPARTMENT_NO = B.DEPARTMENT_NO)
  JOIN TB_PROFESSOR C ON(B.COACH_PROFESSOR_NO = C.PROFESSOR_NO)
  WHERE B.STUDENT_NO = 'A313047';
  
/*12. 2007 년도에 '인간관계론' 과목을 수강한 학생을 찾아 학생이름과 수강학기를 표시하는 SQL 문장을 작성하시오.*/
  
SELECT 
      A.STUDENT_NAME
    , SUBSTR(B.TERM_NO, 5,2)  
  FROM TB_STUDENT A
  JOIN TB_GRADE B ON (A.STUDENT_NO = B.STUDENT_NO)
  JOIN TB_CLASS C ON(B.CLASS_NO = C.CLASS_NO)
  WHERE CLASS_NAME = '인간관계론'
    AND SUBSTR(B.TERM_NO,1,4) = '2007'
  ORDER BY A.STUDENT_NAME;
  
/*? 13. 예체능 계열 과목 중 과목 담당교수를 한 명도 배정받지 못한 과목을 찾아 그 과목
이름과 학과 이름을 출력하는 SQL 문장을 작성하시오.*/

SELECT 
      A.CLASS_NAME
    , B.DEPARTMENT_NAME  
  FROM TB_CLASS A
  JOIN TB_DEPARTMENT B ON(A.DEPARTMENT_NO = B.DEPARTMENT_NO)
 WHERE CATEGORY = '예체능'
 AND A.CLASS_NAME IN(SELECT      
      B.CLASS_NAME  
  FROM TB_STUDENT A
  JOIN TB_CLASS B ON(A.DEPARTMENT_NO = B.DEPARTMENT_NO)
 WHERE A.COACH_PROFESSOR_NO IS NULL);

SELECT      
      B.CLASS_NAME  
  FROM TB_STUDENT A
  JOIN TB_CLASS B ON(A.DEPARTMENT_NO = B.DEPARTMENT_NO)
 WHERE A.COACH_PROFESSOR_NO IS NULL
 GROUP BY B.CLASS_NAME;
 
 /*14. 춘 기술대학교 서반아어학과 학생들의 지도교수를 게시하고자 한다. 학생이름과
지도교수 이름을 찾고 만일 지도 교수가 없는 학생일 경우 "지도교수 미지정‛으로
표시하도록 하는 SQL 문을 작성하시오. 단, 출력헤더는 ‚학생이름‛, ‚지도교수‛로
표시하며 고학번 학생이 먼저 표시되도록 한다.*/


SELECT 
      A.STUDENT_NAME 학생이름
    , C.PROFESSOR_NAME 지도교수이름
 
  FROM TB_STUDENT A
  JOIN TB_DEPARTMENT B ON(A.DEPARTMENT_NO = B.DEPARTMENT_NO)
  JOIN  TB_PROFESSOR C ON(A.COACH_PROFESSOR_NO = C.PROFESSOR_NO)
 WHERE B.DEPARTMENT_NAME = '서반아어학과'
 
 UNION
 
 SELECT 
     A.STUDENT_NAME 학생이름
   , NVL(A.COACH_PROFESSOR_NO,'지도교수 없음')지도교수이름
 
  FROM TB_STUDENT A
  JOIN TB_DEPARTMENT B ON(A.DEPARTMENT_NO = B.DEPARTMENT_NO)
 WHERE B.DEPARTMENT_NAME = '서반아어학과'
   AND COACH_PROFESSOR_NO IS NULL;
   
/*15. 휴학생이 아닌 학생 중 평점이 4.0 이상인 학생을 찾아 그 학생의 학번, 이름, 학과
이름, 평점을 출력하는 SQL 문을 작성하시오.*/   

SELECT
      A.STUDENT_NO 학번
    , A.STUDENT_NAME 이름
    , C.DEPARTMENT_NAME "학과 이름"
    , ROUND(AVG(B.POINT),8) 평점
  FROM TB_STUDENT A
  JOIN TB_GRADE B ON(A.STUDENT_NO  = B.STUDENT_NO)
  JOIN TB_DEPARTMENT C ON (A.DEPARTMENT_NO  = C.DEPARTMENT_NO)
  WHERE ABSENCE_YN = 'N'
  GROUP BY A.STUDENT_NAME ,A.STUDENT_NO, C.DEPARTMENT_NAME
  HAVING ROUND(AVG(B.POINT),8) >= 4.0
  ORDER BY 학번;
